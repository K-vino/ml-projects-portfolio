<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üöÄ ML Model API</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #2c3e50;
            text-align: center;
            margin-bottom: 30px;
        }
        .section {
            margin-bottom: 30px;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 8px;
            background-color: #fafafa;
        }
        .section h2 {
            color: #34495e;
            margin-top: 0;
        }
        .endpoint {
            background: #ecf0f1;
            padding: 15px;
            margin: 10px 0;
            border-radius: 5px;
            border-left: 4px solid #3498db;
        }
        .method {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            color: white;
            font-weight: bold;
            margin-right: 10px;
        }
        .get { background-color: #27ae60; }
        .post { background-color: #e74c3c; }
        code {
            background: #2c3e50;
            color: #ecf0f1;
            padding: 15px;
            border-radius: 5px;
            display: block;
            margin: 10px 0;
            overflow-x: auto;
            white-space: pre-wrap;
        }
        .feature-input {
            margin: 10px 0;
        }
        .feature-input label {
            display: inline-block;
            width: 200px;
            font-weight: bold;
        }
        .feature-input input {
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            width: 100px;
        }
        button {
            background: #3498db;
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px 5px;
        }
        button:hover {
            background: #2980b9;
        }
        #result {
            margin-top: 20px;
            padding: 15px;
            border-radius: 5px;
            display: none;
        }
        .success {
            background: #d5f4e6;
            border: 1px solid #27ae60;
            color: #27ae60;
        }
        .error {
            background: #fdf2f2;
            border: 1px solid #e74c3c;
            color: #e74c3c;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üöÄ Machine Learning Model API</h1>
        
        <div class="section">
            <h2>üìã API Documentation</h2>
            <p>This API provides machine learning predictions using a trained Random Forest model on the Iris dataset.</p>
            
            <div class="endpoint">
                <span class="method get">GET</span>
                <strong>/health</strong> - Health check endpoint
            </div>
            
            <div class="endpoint">
                <span class="method get">GET</span>
                <strong>/model_info</strong> - Get model information
            </div>
            
            <div class="endpoint">
                <span class="method post">POST</span>
                <strong>/predict</strong> - Make single prediction
                <code>{
  "features": [5.1, 3.5, 1.4, 0.2]
}</code>
            </div>
            
            <div class="endpoint">
                <span class="method post">POST</span>
                <strong>/predict_batch</strong> - Make batch predictions
                <code>{
  "samples": [
    [5.1, 3.5, 1.4, 0.2],
    [6.2, 2.8, 4.8, 1.8]
  ]
}</code>
            </div>
        </div>
        
        <div class="section">
            <h2>üß™ Interactive Prediction</h2>
            <p>Enter feature values to get a prediction:</p>
            
            {% for feature in feature_names %}
            <div class="feature-input">
                <label for="feature_{{ loop.index0 }}">{{ feature }}:</label>
                <input type="number" id="feature_{{ loop.index0 }}" step="0.1" value="5.0">
            </div>
            {% endfor %}
            
            <button onclick="makePrediction()">üîÆ Predict</button>
            <button onclick="loadExample()">üìù Load Example</button>
            
            <div id="result"></div>
        </div>
        
        <div class="section">
            <h2>üìä Model Information</h2>
            <p><strong>Model Type:</strong> Random Forest Classifier</p>
            <p><strong>Features:</strong> {{ feature_names|length }}</p>
            <p><strong>Classes:</strong> {{ target_names|length }} ({{ target_names|join(', ') }})</p>
            <p><strong>Feature Names:</strong></p>
            <ul>
                {% for feature in feature_names %}
                <li>{{ feature }}</li>
                {% endfor %}
            </ul>
        </div>
        
        <div class="section">
            <h2>üêç Python Example</h2>
            <code>import requests
import json

# Single prediction
url = "http://localhost:5000/predict"
data = {
    "features": [5.1, 3.5, 1.4, 0.2]
}

response = requests.post(url, json=data)
result = response.json()
print(f"Prediction: {result['prediction_label']}")
print(f"Confidence: {result['confidence']:.3f}")

# Batch prediction
batch_url = "http://localhost:5000/predict_batch"
batch_data = {
    "samples": [
        [5.1, 3.5, 1.4, 0.2],
        [6.2, 2.8, 4.8, 1.8],
        [7.3, 2.9, 6.3, 1.8]
    ]
}

batch_response = requests.post(batch_url, json=batch_data)
batch_result = batch_response.json()
for result in batch_result['results']:
    print(f"Sample {result['sample_id']}: {result['prediction_label']}")
</code>
        </div>
    </div>

    <script>
        function makePrediction() {
            // Collect feature values
            const features = [];
            {% for feature in feature_names %}
            features.push(parseFloat(document.getElementById('feature_{{ loop.index0 }}').value));
            {% endfor %}
            
            // Make API call
            fetch('/predict', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({features: features})
            })
            .then(response => response.json())
            .then(data => {
                const resultDiv = document.getElementById('result');
                if (data.error) {
                    resultDiv.className = 'error';
                    resultDiv.innerHTML = `<strong>Error:</strong> ${data.error}`;
                } else {
                    resultDiv.className = 'success';
                    resultDiv.innerHTML = `
                        <strong>üéØ Prediction Result:</strong><br>
                        <strong>Class:</strong> ${data.prediction_label}<br>
                        <strong>Confidence:</strong> ${(data.confidence * 100).toFixed(1)}%<br>
                        <strong>Probabilities:</strong><br>
                        ${Object.entries(data.probabilities).map(([cls, prob]) => 
                            `&nbsp;&nbsp;${cls}: ${(prob * 100).toFixed(1)}%`
                        ).join('<br>')}
                    `;
                }
                resultDiv.style.display = 'block';
            })
            .catch(error => {
                const resultDiv = document.getElementById('result');
                resultDiv.className = 'error';
                resultDiv.innerHTML = `<strong>Error:</strong> ${error.message}`;
                resultDiv.style.display = 'block';
            });
        }
        
        function loadExample() {
            // Load example values for Iris setosa
            const examples = [
                [5.1, 3.5, 1.4, 0.2],  // setosa
                [6.2, 2.8, 4.8, 1.8],  // virginica
                [5.7, 2.8, 4.1, 1.3]   // versicolor
            ];
            
            const randomExample = examples[Math.floor(Math.random() * examples.length)];
            
            {% for feature in feature_names %}
            document.getElementById('feature_{{ loop.index0 }}').value = randomExample[{{ loop.index0 }}];
            {% endfor %}
        }
    </script>
</body>
</html>
